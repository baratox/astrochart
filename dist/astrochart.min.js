
/*
 * -------------------------------------------------------
 * Project: AstroChart
 * Version: 0.1.0
 *
 * Author:  KpriKornius
 * Site:     
 * Contact: 
 *
 *
 * Copyright (c) 2016 KpriKornius
 * -------------------------------------------------------
 */

"use strict";window.Astrochart=function(){var version="0.1.0",create=function(w,h){function createOrbitPath(cx,cy,r){String.prototype.format||(String.prototype.format=function(){var str=this.toString();if(!arguments.length)return str;var args=typeof arguments[0],args="string"==args||"number"==args?arguments:arguments[0];console.log(args);for(var arg in args)str=str.replace(RegExp("\\{"+arg+"\\}","gi"),args[arg]);return str});var path=chart.path("M {cx}, {cy} m -{r}, 0 a {r},{r} 0 1,0 {d},0 a {r},{r} 0 1,0 -{d},0".format({cx:cx,cy:cy,r:r,d:2*r}));return path.attr("fill","none"),path.attr("stroke","red"),path.attr("stroke-dasharray","1,1"),path}function loadSpaceObject(svg,name,animationDelay){function repeatAnimation(){Snap.animate(0,360,function(value){object.orbit(value)},animationDelay,null,repeatAnimation)}var object=svg.select("g#"+name);chart.append(object),repeatAnimation()}var orbitPath,chart=Snap(w,h);Snap.load("/dist/image/zodiac.svg",function(svg){var zodiac=svg.select("g#zodiac");chart.append(zodiac),orbitPath=createOrbitPath(w/2,h/2,230),Snap.animate(0,-167,function(value){zodiac.transform("r"+value)},6e3)}),Snap.load("/dist/image/things.svg",function(svg){loadSpaceObject(svg,"mercury",3e3),loadSpaceObject(svg,"venus",5e3),loadSpaceObject(svg,"mars",8e3),loadSpaceObject(svg,"jupiter",12e3)}),Snap.plugin(function(Snap,Element){Element.prototype.orbit=function(degrees){var pathLength=orbitPath.getTotalLength(),point=orbitPath.getPointAtLength(degrees*pathLength/360),matrix=new Snap.Matrix;matrix.translate(point.x-54,point.y-54),this.transform(matrix)}}),Snap.plugin(function(Snap,Element,Paper,global){Element.prototype.getTransformedBBox=function(){var bb=this.getBBox(),t=this.node.getTransformToElement(this.node),m=new Snap.Matrix(t);return{cx:m.x(bb.cx,bb.cy),cy:m.y(bb.cx,bb.cy)}}})};return{version:version,create:create}}();